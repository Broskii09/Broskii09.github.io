<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" href="/stats/favicon.ico">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Skin Creator</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
<script src="https://jscolor.com/releases/2.4.5/jscolor.js"></script>
</head>
<body>
<!-- Navigation Menu -->
<nav class="navbar fixed-top navbar-expand-lg navbar-neon">
  <div class="container-fluid"> <a class="navbar-brand" href="#"><strong>Zooming Islander</strong></a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMenu" aria-controls="navbarMenu" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button>
    <div class="collapse navbar-collapse" id="navbarMenu">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="https://guide.zoomingislander.com/" target="new">Zooming Islander Player Guide</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Leader Board</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Server Data</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Patreons</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Staff</a></li>
        <li class="nav-item"> <a class="nav-link" href="https://discord.com/invite/yourserver" target="_blank"><i class="fab fa-discord me-2"></i>Discord</a></li>
        <li class="nav-item dropdown"> <a class="nav-link dropdown-toggle" href="#" id="skinsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Skins</a>
          <ul class="dropdown-menu dropdown-menu-end bg-dark" aria-labelledby="skinsDropdown">
            <li><a class="dropdown-item text-light" href="/skins/custom">Custom Skins</a></li>
            <li><a class="dropdown-item text-light" href="/skins/presets">Presets</a></li>
            <li><a class="dropdown-item text-light" href="/skins/guide">Guide</a></li>
            <li>
              <hr class="dropdown-divider bg-secondary">
            </li>
            <li>
              <h6 class="dropdown-header text-warning">Exclusive Content | Patreon Members Only!</h6>
            </li>
            <li><a class="dropdown-item text-warning fw-bold" href="/skins/custom" target="_blank">Skins Creator</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Main Content -->
<div class="sprite-container">
  <div class="sprite-wrapper">
    <div class="sprite sprite-left"></div>
  </div>
  <div class="title-wrapper">
    <h1 class="site-title">Skin Creator</h1>
  </div>
  <div class="sprite-wrapper">
    <div class="sprite sprite-right"></div>
  </div>
</div>
<div class="container">
  <div class="row g-3 mb-4 justify-content-center">
    <div class="col-12 col-md-6 col-lg-4">
      <label for="md-color" class="form-label">Male Color:</label>
      <div class="input-group">
        <input class="jscolor form-control {pickerClosable:true, pickerPosition:'right'}" id="md-color" value="000000">
        <button class="btn btn-secondary" onclick="useEyeDropper('md-color')"><i class="fas fa-eye-dropper"></i></button>
        <button class="btn btn-success" onclick="copyColor('md-color')"><i class="fas fa-copy"></i></button>
        <button class="btn btn-warning" onclick="pasteColor('md-color')"><i class="fas fa-paste"></i></button>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-4">
      <label for="f-color" class="form-label">High Color:</label>
      <div class="input-group">
        <input class="jscolor form-control {pickerClosable:true, pickerPosition:'right'}" id="f-color" value="000000">
        <button class="btn btn-secondary" onclick="useEyeDropper('f-color')"><i class="fas fa-eye-dropper"></i></button>
        <button class="btn btn-success" onclick="copyColor('f-color')"><i class="fas fa-copy"></i></button>
        <button class="btn btn-warning" onclick="pasteColor('f-color')"><i class="fas fa-paste"></i></button>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-4">
      <label for="m-color" class="form-label">Mid Color:</label>
      <div class="input-group">
        <input class="jscolor form-control {pickerClosable:true, pickerPosition:'right'}" id="m-color" value="000000">
        <button class="btn btn-secondary" onclick="useEyeDropper('m-color')"><i class="fas fa-eye-dropper"></i></button>
        <button class="btn btn-success" onclick="copyColor('m-color')"><i class="fas fa-copy"></i></button>
        <button class="btn btn-warning" onclick="pasteColor('m-color')"><i class="fas fa-paste"></i></button>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-4">
      <label for="d1-color" class="form-label">Mid 2 Color:</label>
      <div class="input-group">
        <input class="jscolor form-control {pickerClosable:true, pickerPosition:'right'}" id="d1-color" value="000000">
        <button class="btn btn-secondary" onclick="useEyeDropper('d1-color')"><i class="fas fa-eye-dropper"></i></button>
        <button class="btn btn-success" onclick="copyColor('d1-color')"><i class="fas fa-copy"></i></button>
        <button class="btn btn-warning" onclick="pasteColor('d1-color')"><i class="fas fa-paste"></i></button>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-4">
      <label for="b-color" class="form-label">Low Color:</label>
      <div class="input-group">
        <input class="jscolor form-control {pickerClosable:true, pickerPosition:'right'}" id="b-color" value="000000">
        <button class="btn btn-secondary" onclick="useEyeDropper('b-color')"><i class="fas fa-eye-dropper"></i></button>
        <button class="btn btn-success" onclick="copyColor('b-color')"><i class="fas fa-copy"></i></button>
        <button class="btn btn-warning" onclick="pasteColor('b-color')"><i class="fas fa-paste"></i></button>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-4">
      <label for="u-color" class="form-label">Bottom Color:</label>
      <div class="input-group">
        <input class="jscolor form-control {pickerClosable:true, pickerPosition:'right'}" id="u-color" value="000000">
        <button class="btn btn-secondary" onclick="useEyeDropper('u-color')"><i class="fas fa-eye-dropper"></i></button>
        <button class="btn btn-success" onclick="copyColor('u-color')"><i class="fas fa-copy"></i></button>
        <button class="btn btn-warning" onclick="pasteColor('u-color')"><i class="fas fa-paste"></i></button>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-4">
      <label for="e-color" class="form-label">Eye Color:</label>
      <div class="input-group">
        <input class="jscolor form-control {pickerClosable:true, pickerPosition:'right'}" id="e-color" value="000000">
        <button class="btn btn-secondary" onclick="useEyeDropper('e-color')"><i class="fas fa-eye-dropper"></i></button>
        <button class="btn btn-success" onclick="copyColor('e-color')"><i class="fas fa-copy"></i></button>
        <button class="btn btn-warning" onclick="pasteColor('e-color')"><i class="fas fa-paste"></i></button>
      </div>
    </div>
  </div>
</div>

<!-- Marks and Pattern Section -->
<div class="row g-3 mb-4 justify-content-center align-items-center">
  <div class="col-sm-6 col-lg-4 d-flex flex-column align-items-center">
    <label for="sv" class="form-label">Marks (sv):</label>
    <input type="number" id="sv" class="form-control text-center" value="0" min="0" max="1">
  </div>
  <div class="col-sm-6 col-lg-4 d-flex flex-column align-items-center">
    <label for="pi" class="form-label">Pattern (pi):</label>
    <input type="number" id="pi" class="form-control text-center" value="0" min="0" max="2">
  </div>
</div>
<div class="row g-2 justify-content-center mb-4">
  <div class="col-auto">
    <button class="btn btn-primary" onclick="generateOutput()" data-bs-toggle="modal" data-bs-target="#outputModal">Generate JSON</button>
  </div>
  <div class="col-auto">
    <button class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#loadModal">Load JSON</button>
  </div>
  <div class="col-auto">
    <button class="btn btn-danger" onclick="resetColors()">Reset</button>
  </div>
  <div class="col-auto">
    <button class="btn btn-info" onclick="randomizeColors()">Randomize Colors</button>
  </div>
</div>
</div>

<!-- Output Modal -->
<div class="modal fade" id="outputModal" tabindex="-1" aria-labelledby="outputModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-sm modal-md modal-lg">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header">
        <h5 class="modal-title" id="outputModalLabel">Generated JSON</h5>
      </div>
      <div class="modal-body">
        <pre id="output"></pre>
      </div>
      <div class="modal-footer">
        <div id="modal-footer-notification" class="text-success d-none ms-3"> 
          <!-- Notification text will appear here --> 
        </div>
        <button class="btn btn-info" onclick="copyToClipboard()">Copy to Clipboard</button>
        <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Load JSON Modal -->
<div class="modal fade" id="loadModal" tabindex="-1" aria-labelledby="loadModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-sm modal-md modal-lg">
    <div class="modal-content bg-dark text-white">
      <div class="modal-header">
        <h5 class="modal-title" id="loadModalLabel">Load JSON</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <textarea id="paste-json" class="form-control json-box" rows="8" placeholder="Paste your JSON here"></textarea>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" onclick="loadFromJson()">Load</button>
        <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script> 
<script>
	// Create Bootstrap modal instance
const loadModal = new bootstrap.Modal('#loadModal');

// Clear textarea when the modal closes
document.getElementById('loadModal').addEventListener('hidden.bs.modal', () => {
  document.getElementById('paste-json').value = '';
});

	
    function copyColor(inputId) {
        const inputElement = document.getElementById(inputId);
        navigator.clipboard.writeText(inputElement.value).catch((error) => {
            console.error("Failed to copy color:", error);
        });
    }

    async function pasteColor(inputId) {
        try {
            const clipboardText = await navigator.clipboard.readText();
            const inputElement = document.getElementById(inputId);

            // Validate if the clipboard text is a valid hex color
            if (/^#([0-9A-F]{3}){1,2}$/i.test(clipboardText)) {
                inputElement.value = clipboardText;
                inputElement.jscolor.fromString(clipboardText.replace("#", ""));
            } else {
                console.warn("Clipboard content is not a valid hex color.");
            }
        } catch (error) {
            console.error("Failed to paste color:", error);
        }
    }

	
	function resetColors() {
    document.querySelectorAll('input.jscolor').forEach(colorInput => {
      colorInput.jscolor.fromString("000000");
    });
    document.getElementById("sv").value = 0;
    document.getElementById("pi").value = 0;
    document.getElementById("output").textContent = "";
  }

  function generateOutput() {
  const colors = {
    sv: document.getElementById("sv").value,
    pi: document.getElementById("pi").value,
  };

  // Map input fields to keys and convert HEX to normalized RGB
  const colorIds = {
    md: "md-color",
    m: "m-color",
    b: "b-color",
    f: "f-color",
    u: "u-color",
    d1: "d1-color",
    e: "e-color",
  };

  for (const [key, id] of Object.entries(colorIds)) {
    const hex = document.getElementById(id).jscolor.toHEXString();
    const r = parseInt(hex.substring(1, 3), 16) / 255;
    const g = parseInt(hex.substring(3, 5), 16) / 255;
    const b = parseInt(hex.substring(5, 7), 16) / 255;

    colors[key] = `X=${r.toFixed(3)},Y=${g.toFixed(3)},Z=${b.toFixed(3)}`;
  }

  const output = JSON.stringify(colors, null, 2).replace(/\"/g, "'");
  document.getElementById("output").textContent = output;
}

  function copyToClipboard() {
  const output = document.getElementById("output").textContent;
  navigator.clipboard.writeText(output)
    .then(() => {
      const notification = document.getElementById("modal-footer-notification");
      notification.textContent = "Copied to clipboard!";
      notification.classList.remove("d-none");

      // Hide the notification after 2 seconds
      setTimeout(() => {
        notification.classList.add("d-none");
        notification.textContent = ""; // Clear the text after hiding
      }, 2000);
    })
    .catch(console.error);
}


 function loadFromJson() {
  try {
    let jsonString = document.getElementById("paste-json").value.trim();

    // Replace single quotes with double quotes for valid JSON parsing
    jsonString = jsonString.replace(/'/g, '"');

    // Parse the JSON
    const json = JSON.parse(jsonString);

    // Validate required keys
    const requiredKeys = ["sv", "pi", "md", "m", "b", "f", "u", "d1", "e"];
    for (const key of requiredKeys) {
      if (!(key in json)) {
        alert(`Missing key: ${key}`);
        throw new Error(`Missing key: ${key}`);
      }
    }

    // Update Marks and Pattern values
    document.getElementById("sv").value = json.sv;
    document.getElementById("pi").value = json.pi;

    // Update color pickers
    const colorIds = {
      md: "md-color",
      m: "m-color",
      b: "b-color",
      f: "f-color",
      u: "u-color",
      d1: "d1-color",
      e: "e-color",
    };

    for (const [key, id] of Object.entries(colorIds)) {
      if (key in json) {
        const matches = json[key].match(/X=([\d.]+),Y=([\d.]+),Z=([\d.]+)/);
        if (matches) {
          const [_, r, g, b] = matches;
          const hexColor = rgbToHex(parseFloat(r), parseFloat(g), parseFloat(b));
          document.getElementById(id).jscolor.fromString(hexColor);
        }
      }
    }

    // Auto-close the modal on success
    loadModal.hide();
  } catch (error) {
    console.error("Error loading JSON:", error);
    alert("Invalid JSON format. Please check your input.");
  }
}


// Helper function to convert normalized RGB to HEX
function rgbToHex(r, g, b) {
  const to255 = (value) => Math.min(Math.max(0, Math.round(value * 255)), 255);
  return `#${((1 << 24) + (to255(r) << 16) + (to255(g) << 8) + to255(b))
    .toString(16)
    .slice(1)
    .toUpperCase()}`;
}


  function randomizeColors() {
    document.querySelectorAll('input.jscolor').forEach(colorInput => {
      const randomColor = Math.floor(Math.random() * 16777215).toString(16).padStart(6, "0");
      colorInput.jscolor.fromString(randomColor);
    });
  }

  async function useEyeDropper(inputId) {
    if (window.EyeDropper) {
      const eyeDropper = new EyeDropper();
      try {
        const result = await eyeDropper.open();
        document.getElementById(inputId).jscolor.fromString(result.sRGBHex.substring(1));
      } catch (err) {
        console.error("Eyedropper cancelled", err);
      }
    } else {
      alert("The EyeDropper API is not supported in this browser.");
    }
  }
</script>
</body>
</html>
